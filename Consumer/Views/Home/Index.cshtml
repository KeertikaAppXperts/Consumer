@model Tuple<IEnumerable<SelectListItem>>
@{
    ViewBag.Title = "Home Page";
}

<html>

<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="~/Scripts/jquery-3.4.1.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.8/js/jquery.dataTables.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.8/css/jquery.dataTables.min.css">

  
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/i18n/zh-TW.min.js" integrity="sha512-whWyZS4LtoXu4LzFJbHIgL9Cr7Sf2+KyeEAGumtXN+8U234v1R89monfd9PLYnC0TNBArmPnkFOVo8ShuMpZaw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    <p></p>
    <button type="button" class="btn btn-success" data-toggle="modal" data-target="#exampleModal">  Add Customer</button> <label>  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;  &nbsp; Customer Record  </label><p> </p>
    <div style="border-width:20px;border-radius:15px;border-color:gainsboro;margin-bottom:100px" id="exampleModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content" style="background-color:gainsboro">
                <div class="modal-header" style="border-color:gainsboro; background-color:gainsboro; border-radius:5px">
                    <h2 class="modal-title" align="center"> New Customer!</h2>

                </div>
                <div class="modal-body  form" style="width:fit-content ">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-3">
                                <label for="lname" class="col-form-label">Customer Code</label>
                                <input type="text" class="form-control" id="customercode" name="customercode" disabled>
                            </div>
                            <div class="col-md-3">
                                <label for="name" class="col-form-label"> Customer Name </label>
                                <input type="text" class="form-control" id="name" placeholder="Sample"><input type="hidden" id="hdncustomercode" value="0">
                            </div>
                        </div><br>
                        <div class="row">
                            <div class="col-md-3">
                                <label for="mobile" class="col-form-label">Mobile</label>
                                <input type="text" class="form-control" id="mobile" placeholder="123456789">
                            </div>

                            <div class="col-md-3">

                                <label for="email" class="col-form-label">Email</label>
                                <input type="text" class="form-control" id="email" placeholder="sample@gmail.com">

                            </div>
                        </div><br>
                        <div class="row">
                            <div class="col-md-3">

                                <label for="address" class="col-form-label" style="text-align:center">Address</label>
                                <input type="text" class="form-control" id="address" placeholder="No.xx yy place">

                            </div>


                            <div class="col-md-3">

                                <label for="city" class="col-form-label">City</label>
                                <input type="text" class="form-control" id="city" placeholder="City">
                            </div>
                        </div><br>
                        <div class="row">

                            <div class="col-md-3 form-group">
                                <label for="country" style="margin-top:6px">Country</label> <div>
                                    <p></p>
                                    <select name="country" id="country" style="min-width:215px; border-color:gainsboro; height:35px;border-radius:5px ">
                                        <option value="" disabled selected style="color:lightslategrey">- - select - -</option>
                                        <option value="India">India</option>
                                        <option value="Others">Others</option>
                                    </select>
                                </div>
                            </div> <p> </p>
                            <div class="col-md-3">

                                <label for="gender"> Gender</label> <p> </p>
                                <input type="radio" name="gender" class="radiobtn" id="gender" value="Female" />
                                Female
                                <input type="radio" name="gender" class="radiobtn" id="gender" value="Male" />
                                Male
                            </div>

                        </div><br>

                    </div>


                    @*<div class="modal-footer">      <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        </div></div>*@
                    @*<div style="width:100%;height:100%;background-color:gainsboro">cdksdc</div>*@

                    <div class="modal-footer" style="height:fit-content;padding-bottom:50px;padding-right:30px;display:inline-block">
                        <button style="align-content:center ;position:fixed; right:90px" type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                        <button style="align-content: center;position: fixed; right: 20px" type="button" onclick="saveCustomer()" class="btn btn-success">Save</button>
                    </div>

                </div>
            </div>
        </div>
    </div>


    <div class="container">
        <table id="table_id" class="table table-striped table-responsive table-condensed table-bordered" width="100%" border="1" align="center">
            <thead class="table-hover">
                <tr>
                    <th align="center">Customer Code</th>
                    <th>Customer Name</th>
                    <th>Mobile</th>
                    <th>Email</th>
                    <th>Address</th>
                    <th>City</th>
                    <th>Gender</th>
                    <th>Country</th>
                    <th>Action</th>
                </tr>
                <tr>
                </tr>

            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    @*<div>
        <select id="demo">
            <option value="" selected hidden>Select product</option>
            <option></option>
        </select>



    </div>*@

</body>
</html>
<script>
    $(document).ready(function () {
        GetAll();
    });
    function ResetData() {
        $("#name").val('');
        $("#mobile").val('');
        $("#email").val('');
        $("#address").val('');
        $("#city").val('');
        $("input[type=radio][name=gender]").prop('checked', false);
        $('#country').val('');

    }
    function saveCustomer() {
        debugger
        var code = $("#hdncustomercode").val();
        var name = $("#name").val();
        var mobile = $("#mobile").val();
        var email = $("#email").val();
        var address = $("#address").val();
        var city = $("#city").val();
        var gender = $("input[name='gender']:checked").val();
        var country = $('#country').val();
        var custobj = new Object();
        custobj.CustomerCode = code;
        custobj.CustomerName = name;
        custobj.Mobile = mobile;
        custobj.Email = email;
        custobj.Address = address;
        custobj.City = city;
        custobj.Gender = gender;
        custobj.Country = country;

        $.ajax(
            {
                type: "POST",
                url: "/Home/AddCustomer",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({
                    header: JSON.stringify(custobj)
                }),
                dataType: "json",
                async: false,
                success: function (data) {
                    if (data != null) {
                        if (data == 'Success') {
                            alert('Customer Saved Successfully');
                            ResetData();
                            GetAll();
                        }
                    }
                },

                failure: function (response) {
                    alert(response.d);
                }

            });
    }
    function GetAll() {
        debugger
        $.ajax({
            type: "POST",
            url: "/Home/GetAll",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: false,
            success: function (data) {
                debugger
                if (data != null) {
                    $.each(data, function (key, value) {
                        var Row = "";
                        Row += "<tr id='rowdata'>";
                        Row += "<td>" + value.CustomerCode + "</td>";
                        Row += "<td>" + value.CustomerName + "</td>";
                        Row += "<td>" + value.Mobile + "</td>";
                        Row += "<td>" + value.Email + "</td>";
                        Row += "<td>" + value.Address + "</td>";
                        Row += "<td>" + value.City + "</td>";
                        Row += "<td>" + value.Gender + "</td>";
                        Row += "<td>" + value.Country + "</td>";
                        Row += "<td><input type='hidden' id='hdncode' name='hidden' value='" + value.CustomerCode + "'><button class='btn btn-primary' type='button' onclick='editCustomer(this)' data-toggle='modal' data-target='#exampleModal'><i class='fa-solid fa-user-pen'></i></button>&nbsp; <button class='btn btn-primary'  onclick='remove(this)' type='button' ><i class='fa-solid fa-trash-can'></i></button> </td></tr>";
                        //Row += "<td><input type='hidden' id='hdncode' name='hidden' value='" + value.CustomerCode + "'><input type='button' value='Remove' name='remove' class='btn btn-primary' onclick='remove(this)' /><input type='button' value='edit' name='Edit' class='btn btn-primary' data-toggle='modal' data-target='#exampleModal' onclick='editCustomer(this)'/></td></tr>";
                        /*Row += "<td><input type='hidden' id='hdncode' name='hidden' value='" + value.CustomerCode +"'> <input type='button' value='Remove' name='remove' class='btn btn-primary' onclick='RemoveItem(this)'/> <input type='button' name='edit' value='Edit' class='btn btn-primary' data-toggle='modal' data-target='#exampleModal' onclick='editCustomer(this)'/> </td> </tr>";*/
                        $("#table_id tbody").append(Row);
                    });

                }
            },

            failure: function (response) {
                alert(response.d);
            }
        });

    }
    //function RemoveItem(CustomerCode) {
    //    $(CustomerCode).closest('tr').remove();
    //}
    function editCustomer(element) {

        var code = $(element).closest('tr').find("#hdncode").val();


        $.ajax(
            {
                type: "POST",
                url: "/Home/EditCustomer",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({
                    header: code
                }),
                dataType: "json",
                async: false,
                success: function (data) {
                    if (data != null) {
                        $("#name").val(data.CustomerName);
                        $("#mobile").val(data.Mobile);
                        $("#email").val(data.Email);
                        $("#address").val(data.Address);
                        $("#city").val(data.City);
                        /*                        $("#gender").val(data.Gender).click();*/
                        $("input[name='gender']:checked").val(data.Gender);
                        /*$("#gender").val(data.Gender);*/
                        //$("").prop("checked", true).trigger("click");
                        $("#country").val(data.Country);
                        $("#hdncustomercode").val(data.CustomerCode);

                        $("input:radio[value=" + data.Gender + "]").attr("checked", 'checked');

                    }
                },

                failure: function (response) {
                    alert(response.d);
                }

            });
    }
    //deleting

    function remove(element) {

        var code = $(element).closest('tr').find("#hdncode").val();
        var row;
        $.ajax(
            {
                url: "/Home/RemoveCustomer",
                data: JSON.stringify({
                    CustomerCode: code
                }),
                type: "POST",
                async: false,
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                success: function (data) {
                    if (data != null) {
                        GetAll();
                    }
                },
                error: function (errormessage) {

                }
            });
    }
    //var prodlist = ["rice", "apple", "candy", "chips", "popstick", "gonemad"];
    //$("#demo").select2({
    //    data: prodlist
    //});


//      var code = $(CustomerCode).closest('tr').remove();
//    var ans = confirm("Are you sure you want to delete this Recor+-d?");
//    if (ans)

//        $.ajax({
//            url: "/Home/RemoveCustomer/",
//            type: "POST",
//            contentType: "application/json;charset=UTF-8",
//            dataType: "json",
//            success: function (result) {
//                GetAll();
//            },
//            error: function (errormessage) {
//                alert(errormessage.responseText);
//            }
//        });

//}


</script>